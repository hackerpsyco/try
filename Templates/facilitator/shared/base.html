{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Facilitator Dashboard{% endblock %}</title>
    
    <!-- SMOOTH SCROLLING BASE STYLES -->
    <style>
        /* GLOBAL SMOOTH SCROLLING FOR ALL DEVICES */
        html {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
        }
        
        body {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
            max-width: 100vw;
        }
        
        /* Smooth scrolling for all elements */
        * {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Prevent horizontal scroll issues */
        .wrapper, .main-content, .content-area {
            overflow-x: hidden;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Sidebar smooth scrolling */
        .sidebar {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            /* Hardware acceleration */
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
            will-change: transform;
            /* Smooth scrollbar */
            scrollbar-width: thin;
            scrollbar-color: #d1d5db #f3f4f6;
        }
        
        /* Webkit scrollbar styling */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: #f3f4f6;
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 10px;
        }
        
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
        
        /* Mobile smooth scrolling fixes */
        @media (max-width: 991px) {
            body {
                position: relative;
                overflow-x: hidden;
            }
            
            .sidebar {
                -webkit-transform: translateZ(0);
                transform: translateZ(0);
                will-change: transform;
            }
            
            .sidebar.show {
                -webkit-transform: translateZ(0) translateX(0);
                transform: translateZ(0) translateX(0);
            }
        }
        
        /* Smooth transitions for all interactive elements */
        .nav-link, .btn, .card {
            transition: all 0.3s ease;
        }
        
        /* Prevent scroll bounce on iOS */
        .main-content {
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: contain;
        }
    </style>
  

    <!-- Favicon via CDN -->
    <link rel="icon" type="image/jpg" href="https://clas.wazireducationsociety.org/static/images/wes-logo.jpg">
    
    <!-- Bootstrap 5 - Primary CDN (jsDelivr) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- FontAwesome for icons - Fallback CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" integrity="sha512-iecdLmaskl7CVJkEZSMUkrQ6usKu8zIvxUivvrQolCXAQHD9/RC5YqPleTk+Z3daV1UWP3V3zNqiiGPUUEpLFQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
    
    <!-- Custom CSS via CDN (using jsDelivr) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wazireducationsociety/clas@main/static/css/admin_dashboard.css"/>
    
    <!-- Extra CSS Block for page-specific styles -->
    {% block extra_css %}{% endblock %}
</head>
<body>

<!-- Sidebar overlay for mobile -->
<div id="sidebarOverlay" class="sidebar-overlay"></div>

<div class="wrapper">
    {% include 'facilitator/shared/sidebar.html' %}
    
    <main class="main-content">
        {% include 'facilitator/shared/topbar.html' %}

        <div class="content-area">
            {% block content %}{% endblock %}
        </div>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9uj1KfSVFFLlHWYDu94PA7IloocVe23KE+0KqLjriPlSiLsbErvC/mQ6" crossorigin="anonymous"></script>

<!-- Sidebar Toggle Script with Smooth Scrolling -->
<script>
(function() {
  'use strict';
  
  const toggleBtn = document.getElementById("sidebarToggle");
  const sidebar = document.querySelector(".sidebar");
  const overlay = document.getElementById("sidebarOverlay");
  const body = document.body;

  // Smooth scrolling function
  function enableSmoothScrolling() {
    // Add smooth scrolling to all scrollable elements
    const scrollableElements = document.querySelectorAll('.sidebar, .main-content, .content-area, body, html');
    scrollableElements.forEach(element => {
      element.style.scrollBehavior = 'smooth';
      element.style.webkitOverflowScrolling = 'touch';
    });
  }

  // Initialize smooth scrolling
  enableSmoothScrolling();

  // Sidebar toggle with smooth animations
  function toggleSidebar() {
    if (!sidebar || !overlay) return;
    
    const isOpen = sidebar.classList.contains("show");
    
    if (isOpen) {
      // Close sidebar
      sidebar.classList.remove("show");
      overlay.classList.remove("show");
      body.style.overflow = '';
      body.style.position = '';
    } else {
      // Open sidebar
      sidebar.classList.add("show");
      overlay.classList.add("show");
      // Prevent background scrolling on mobile
      body.style.overflow = 'hidden';
      body.style.position = 'fixed';
      body.style.width = '100%';
    }
  }

  // Event listeners
  if (toggleBtn) {
    toggleBtn.addEventListener("click", toggleSidebar);
  }

  if (overlay) {
    overlay.addEventListener("click", function() {
      sidebar.classList.remove("show");
      overlay.classList.remove("show");
      body.style.overflow = '';
      body.style.position = '';
    });
  }

  // Handle window resize with smooth transitions
  let resizeTimeout;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(function() {
      if (window.innerWidth >= 992) {
        // Desktop - ensure sidebar is visible and overlay is hidden
        sidebar.classList.remove("show");
        overlay.classList.remove("show");
        body.style.overflow = '';
        body.style.position = '';
      }
      // Re-enable smooth scrolling after resize
      enableSmoothScrolling();
    }, 150);
  });

  // Smooth scroll to top function
  window.scrollToTop = function() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  };

  // Add smooth scroll to all internal links
  document.addEventListener('click', function(e) {
    const link = e.target.closest('a[href^="#"]');
    if (link) {
      e.preventDefault();
      const target = document.querySelector(link.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    }
  });

  // Prevent scroll issues on mobile
  let touchStartY = 0;
  document.addEventListener('touchstart', function(e) {
    touchStartY = e.touches[0].clientY;
  }, { passive: true });

  document.addEventListener('touchmove', function(e) {
    const touchY = e.touches[0].clientY;
    const touchDelta = touchY - touchStartY;
    
    // Prevent overscroll bounce
    if (sidebar && sidebar.classList.contains('show')) {
      const sidebarScrollTop = sidebar.scrollTop;
      const sidebarScrollHeight = sidebar.scrollHeight;
      const sidebarClientHeight = sidebar.clientHeight;
      
      if ((sidebarScrollTop === 0 && touchDelta > 0) || 
          (sidebarScrollTop >= sidebarScrollHeight - sidebarClientHeight && touchDelta < 0)) {
        e.preventDefault();
      }
    }
  }, { passive: false });

  // Initialize on load
  document.addEventListener('DOMContentLoaded', function() {
    enableSmoothScrolling();
    
    // Ensure proper mobile layout
    if (window.innerWidth < 992) {
      sidebar.classList.remove("show");
      overlay.classList.remove("show");
      body.style.overflow = '';
      body.style.position = '';
    }
  });

})();
</script>

</body>
</html>
